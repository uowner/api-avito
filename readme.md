###############################

Использован софт:
Apache 2.4 - PHP 7.0-7.1
PHP 7.1
MySQL 8.0

###############################

Запуск:
Загрузить файлы на веб-сервер
Загрузить SQL-Дамп базы данных
Настроить файл .htaccess (есть пример чуть ниже)
В файле api.php настроить данные для подключения к базе данных (Строки 4-7)
В файлах http-test.php и json-test.php поменять значение переменной $domain на свой адрес домена, на котором доступны загруженные файлы

###############################

Содержимое файла .htaccess

RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^((?s).*)$ api.php?_url=/$1 [QSA,L]


###############################

Комментарии: 

Баланс пользователя в базе хранится как BIG INTEGER, где дробная часть баланса - последние 4 цифры этого числа.
Т.е. чтобы узнать "реальный" баланс пользователя, значение поля 'balance' таблицы 'users' необходимо разделить на 10,000.
А перед тем как сохранить в базу данных обновленный баланс необходимо значение в рублях (дробное) умножить на 10,000.
Это сделано для того чтобы избежать ошибок округления при работе с float-типами, поскольку нам необходима 100% гарантия точности при работе с балансами пользователей.
Максимальная точность - 4 знака после запятой, думаю что такого уровня точности более чем хватит для обычных задач (интернет-магазин и большинство веб-сервисов).
В случае необходимости точность можно повысить сколь угодно отредактировав код.

Взаимодействовать с API можно двумя способами:
1) Передавая все данные в адресной строке браузера (по HTTP)
2) Передавая все данные в json-формате на адрес /api
К каждому методу есть примеры двумя способами.

Есть три метода для начисления/списания средств:
user_balance_add, user_balance_sub, user_balance_subadd
Первый исключительно добавляет средства, второй исключительно списывает средства, а третий является универсальным.
Сделал так чтобы был выбор: кому какой метод удобнее, тот такой и использует. 

Для теста JSON-POST (json-test.php) не писал сильно много проверок, так как все взаимодействия с api осуществляются точно так же как и по HTTP (http-test.php) различается лишь способ передачи входных данных нашему скрипту.

###############################

Запрос баланса пользователя:
/api/user_balance_get/USER_ID/CURRENCY

USER_ID - ID Пользователя чей баланс мы хотим запросить из базы данных
CURRENCY - 3х символьный код валюты в которой нужно получить баланс (Не обязательный параметр, если не указан результат будет в RUB)

Примеры: 
/api/user_balance_get/1 - Запросить баланс пользователя #1 в валюте RUB (валюта по умолчанию)
/api/user_balance_get/24/USD - Запросить баланс пользователя #24 в валюте USD (Доллар США)
/api/user_balance_get/11/GBP - Запросить баланс пользователя #11 в валюте GBP (Британский Фунт)

Пример JSON-POST запроса:
{"method":"user_balance_get","user_id":2,"currency":"EUR"} - Запросить баланс пользователя с ID #2 в валюте EUR

###############################

Добавление средств на баланс пользователя:
/api/user_balance_add/USER_ID/AMOUNT/COMMENT

USER_ID - ID Пользователя чей баланс мы хотим увеличить
AMOUNT - Сумма в рублях которую необходимо добавить на баланс пользователя с точностью до 4х знаков после точки (прим. 0.0001 рубля) ! Только положительные значения !
COMMENT - Комментарий для данной операции (Не обязательный параметр)

Примеры:
/api/user_balance_add/1/0.6 - Зачислить на баланс пользователя с ID #1 сумму в размере 60 копеек. В комментарии к данной операции будет указан комментарий по умолчанию. 
/api/user_balance_add/1/1001.2002/TEST_OPERATION - Зачислить на баланс пользователя с ID #1 сумму в размере 1001.2002 рубля (1001 рубль 20 копеек и еще 0.02 копейки) в комментарии к операции будет указано TEST_OPERATION

Пример JSON-POST запроса:
{"method":"user_balance_add","user_id":2,"amount":"500"} - Начислить пользователю с ID #2 - 500 рублей

###############################

Списание средств с баланса пользователя:
/api/user_balance_sub/USER_ID/AMOUNT/COMMENT

USER_ID - ID Пользователя чей баланс мы хотим уменьшить
AMOUNT - Сумма в рублях которую необходимо списать с баланса пользователя с точностью до 4х знаков после точки (прим. 0.0001 рубля) ! Только положительные значения !
COMMENT - Комментарий для данной операции (Не обязательный параметр)

Примеры:
/api/user_balance_sub/1/0.6 - Списать с баланса пользователя с ID #1 сумму в размере 60 копеек. В комментарии к данной операции будет указан комментарий по умолчанию. 
/api/user_balance_sub/1/1001.2002/TEST_OPERATION - Списать с баланса пользователя с ID #1 сумму в размере 1001.2002 рубля (1001 рубль 20 копеек и еще 0.02 копейки) в комментарии к операции будет указано TEST_OPERATION

Пример JSON-POST запроса:
{"method":"user_balance_sub","user_id":2,"amount":"500"} - Списать с пользователя с ID #2 - 500 рублей

###############################

Универсальная функция списания/зачисления средств на баланс пользователя:
/api/user_balance_subadd/USER_ID/AMOUNT/COMMENT

USER_ID - ID Пользователя чей баланс мы хотим уменьшить/увеличить
AMOUNT - Сумма в рублях которую необходимо списать/зачислить на баланс пользователя с точностью до 4х знаков после точки (прим. 0.0001 рубля) ! Положительные значения - зачисление средств, Отрицательные значения - списание средств !
COMMENT - Комментарий для данной операции (Не обязательный параметр)

Примеры:

Операции списания:
/api/user_balance_subadd/1/-50.5 - Списать с баланса пользователя с ID #1 сумму в размере 50 рублей 50 копеек. В комментарии к данной операции будет указан комментарий по умолчанию. 
/api/user_balance_subadd/4/-250.41/TEST_OPERATION - Списать с баланса пользователя с ID #4 сумму в размере 250 рублей 41 копейка. В комментарии к операции будет указано TEST_OPERATION

Операции зачисления: 
/api/user_balance_subadd/1/50.5 - Зачислить на баланс пользователя с ID #1 сумму в размере 50 рублей 50 копеек. В комментарии к данной операции будет указан комментарий по умолчанию. 
/api/user_balance_subadd/4/250.41/TEST_OPERATION - Зачислить на баланс пользователя с ID #4 сумму в размере 250 рублей 41 копейка. В комментарии к операции будет указано TEST_OPERATION

Пример JSON-POST запроса:
{"method":"user_balance_subadd","user_id":2,"amount":"500"} - Начислить пользователю с ID #2 - 500 рублей
{"method":"user_balance_subadd","user_id":2,"amount":"-500"} - Списать с пользователя с ID #2 - 500 рублей

###############################

Перевод средств между пользователями:
/api/user_balance_transfer/ID_SENDER/ID_RECEIVER/AMOUNT

ID_SENDER - ID Пользователя чей баланс мы хотим уменьшить (Отправитель средств)
ID_RECEIVER - ID Пользователя чей баланс мы хотим увеличить (Получатель средств)
AMOUNT - Сумма в рублях которую необходимо переместить между пользователями с точностью до 4х знаков после точки (прим. 0.0001 рубля) ! Только положительные значения !

Примеры:
/api/user_balance_transfer/1/2/1000 - Переместить сумму в размере 1000 рублей 00 копеек с баланса пользователя ID #1 на баланс пользователя ID #2
/api/user_balance_transfer/12/4/0.15 - Переместить сумму в размере 0 рублей 15 копеек с баланса пользователя ID #12 на баланс пользователя ID #4

Пример JSON-POST запроса:
{"method":"user_balance_transfer","id_sender":1,"id_receiver":2,"amount":"100"} - Списать с пользователя с ID #1 100 рублей и зачислить их пользователю с ID #2

###############################

Получение истории транзакций пользователя:
/api/user_balance_history_get/USER_ID/MAX_TRANSACTIONS/PAGE/ORDER/SORT

USER_ID - ID Пользователя чью историю транзакций мы хотим получить
MAX_TRANSACTIONS - Максимальное число операций на одну страницу
PAGE - Порядковый номер страницы
ORDER - Сортировка по параметру. Допустимые значения:
	Date - отсортировать операции по дате
	ID - отсортировать операции по ID транзакции (аналогично Date)
	Amount - отсортировать операции по сумме
SORT - тип сортировки. Допустимые значения:
	DESC - сортировка по убыванию
	ASC - сортировка по возрастанию

Примеры:
/api/user_balance_history_get/1/10/0/Amount/DESC - Получить список операций пользователя с ID #1, максимум 10 операций на 1 страницу, вывести начиная с 0 страницы сортируя по убыванию по сумме операции
/api/user_balance_history_get/1/5/1/Amount/ASC - Получить список операций пользователя с ID #1, максимум 5 операций на 1 страницу, вывести начиная с 1 страницы сортируя по возрастанию по сумме операции
/api/user_balance_history_get/4/5/2/Date/ASC - Получить список операций пользователя с ID #4, максимум 5 операций на 1 страницу, вывести начиная с 2 страницы сортируя по возрастанию по дате осуществления операции

Пример JSON-POST запроса:
{"method":"user_balance_history_get","user_id":1,"max_transactions":3,"page":0} - Запросить историю операций пользователя с ID #1, максимум 3 операции на страницу, показать страницу 0. Сортировка по умолчанию.
{"method":"user_balance_history_get","user_id":1,"max_transactions":3,"page":3,"order":"amount","sort":"DESC"} - Запросить историю операций пользователя с ID #1, максимум 3 операции на страницу, показать страницу 3. Сортировка по сумме операции по убыванию.

###############################